# SPDX-License-Identifier: MIT OR AGPL-3.0-or-later
# SPDX-FileCopyrightText: 2024-2025 hyperpolymath
#
# Nginx configuration for well-known resources
# Include this in your server block: include /path/to/well-known.conf;

# Well-known resources location
location /.well-known/ {
    # Serve from a dedicated directory
    alias /var/www/well-known/;

    # Default MIME type for well-known resources
    default_type text/plain;

    # Specific content types
    location ~ \.json$ {
        default_type application/json;
    }

    # Security headers
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-Frame-Options "DENY" always;

    # Cache control - short cache for security.txt
    location = /.well-known/security.txt {
        add_header Cache-Control "public, max-age=3600";
    }

    # Longer cache for static resources
    location = /.well-known/assetlinks.json {
        add_header Cache-Control "public, max-age=86400";
    }

    location = /.well-known/apple-app-site-association {
        default_type application/json;
        add_header Cache-Control "public, max-age=86400";
    }
}

# Alternative: Inline security.txt without external file
# Uncomment and customize the heredoc below
#
# location = /.well-known/security.txt {
#     default_type text/plain;
#     return 200 "Contact: mailto:security@example.com
# Expires: 2026-12-31T23:59:59Z
# Preferred-Languages: en
# Canonical: https://example.com/.well-known/security.txt
# ";
# }
